<?xml version="1.0" encoding="UTF-8"?>
<entityConf xsi:noNamespaceSchemaLocation="../../entityconf.xsd"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" backend="com.ant.crawler.core.ListSiteCrawler">

	<entityFields>
		<rssSite>
		</rssSite>
		<listSite>
			<itemXpath>//div[@id="entries-content-ul"]/div[@class="gag-link"]</itemXpath>
			<field xpath="div[1]/div[1]/a/@href" name="tempSource">
				<filter type="scriptone">
					<![CDATA[
						var URL = Java.type("java.net.URL");
						var url = new URL(entity.getSourceUrl(), field);
						entity.setDetailUrl(url);
					]]>
				</filter>
			</field>
			<field xpath="div[1]/div[1]/a/img/@src" name="thumbnail">
				<filter type="scriptone">
					<![CDATA[
						var URL = Java.type("java.net.URL");
						var url = new URL(entity.getSourceUrl(), field);
						field= url.toString();
						var Date = Java.type("java.util.Date");
						var today = new Date();
						entity.set("create_date", today);
						entity.set("owner_id", "1");
						entity.set("type", 2);
						var ThreadLocalRandom = Java.type("java.util.concurrent.ThreadLocalRandom");
						entity.set("view", ThreadLocalRandom.current().nextInt(300, 400));
						entity.set("like_count", 0);
					]]>
				</filter>
			</field>
			<field xpath="div[@class='post-info']/div[1]/h1/a/text()" name="title">
				<filter type="scriptone">
					<![CDATA[ field = field.trim(); ]]>
				</filter>
			</field>
		</listSite>
		<detailSite>
			<field xpath="//object[@id='flashplayer']/embed/@flashvars" name="content">
				<filter type="scriptone">
					<![CDATA[
					 var prefix = "//www.youtube.com/watch?v=";
					 var index = field.indexOf(prefix);
					 if (index == -1) {
					 	field = null;
					 	return;
					 }
					 index += prefix.length();
					 var end = field.indexOf("#", index);
					 field = end == -1 ? field.substring(index) : field.substring(index, end);
					  ]]>
				</filter>
			</field>
		</detailSite>
	</entityFields>
	<categories mappingField="category_id">
		<category id="1">
			http://chatvl.com/
		</category>
	</categories>
</entityConf>